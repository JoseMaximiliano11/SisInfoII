<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="POSTULANTES" content="width=device-width, initial-scale=1.0">
  <title>PosUniversidad</title>
<link rel="stylesheet" href="CSS/styles.css">
<script src="js/config.js"></script>
<script src="js/app.js"></script>
<script>
    
    document.addEventListener('DOMContentLoaded', function() {
        console.log('Proyecto conectado con Supabase');
    });
</script>
</head>


    <body>
        <div class="container">
    <h1>Registro de Postulaci√≥n</h1>

   <form id="registroForm" onsubmit="event.preventDefault(); Validacion();">
      <label for="nombre">Nombre Completo:</label>
      <input type="text" id="nombre" name="nombre" placeholder="Ingresa tu nombre" required>
      <br><br>

      <label for="ci">N√∫mero de C.I.:</label>
      <input type="text" id="ci" name="ci" placeholder="Ej: 12345678" minlength="7" maxlength="8" required>
      <br><br>.

      <label for="email">Correo Electr√≥nico:</label>
      <input type="email" id="email" name="email" placeholder="ejemplo@correo.com" required>
      <br><br>

      <label for="password">password:</label>
      <input type="password" id="password" name="password" minlength="7" maxlength="8" placeholder ="password" required>
      <br><br>
      <label for="carrera">facultad a Postular:</label>
            <select id="carrera" name="facultad" required>
                <option value="">Seleccione...</option>
                <option value="tecnologia">Ingenier√≠a</option>
                <option value="medicina">Medicina</option>
                <option value="derecho">Derecho</option>
                <option value="arquitectura">Arquitectura</option>
                <option value="economia">economia</option>
            </select><br></br>

      <button type="submit">Registrar</button>
    </form>
  </div>
    
  
<script>
var nombre = document.getElementById("nombre");
var ci = document.getElementById("ci");
var email = document.getElementById("email");
var password = document.getElementById("password");
var carrera = document.getElementById("carrera");

var expRegNombre=/^[a-zA-Z√ë√±√Å√°√â√©√ç√≠√ì√≥√ö√∫√ú√º\s]+$/;
var expRegEmail=/^[\w-\.]+@([\w-]+\.)+[\w-]{2,4}$/;
var expRegNumeros=/^[0-9]*$/;

async function Validacion(){
    if(!expRegNombre.test(nombre.value)){
       alert("Aqui solo van letras :)");
       nombre.focus();
       return false;
   }else if(!expRegNumeros.test(ci.value)){
        alert("Aqui solo van Numeros");
        ci.focus();
        return false;
    }else if (!expRegEmail.test(email.value)) {
        alert("Ingrese un correo v√°lido (ejemplo: usuario@gmail.com)");
        email.focus();
        return false;
    }

    try {
        console.log('Intentando guardar en Supabase...');
        
        const resultado = await registrarPostulante(
            nombre.value,
            ci.value,
            email.value,
            password.value,
            carrera.value
        );

        console.log('üì• Resultado:', resultado);

        if (resultado && resultado.length > 0) {
            alert("¬°REGISTRADO con √©xito! üéâ\n\nAhora proceda con el registro de pago.");
            console.log('‚úÖ Postulante guardado:', resultado[0]);
            
            // Redirigir a la p√°gina de pago
            window.location.href = 'pago.html';
            return true;
        } else {
            alert("Error al guardar en la base de datos");
            return false;
        }
    } catch (error) {
        console.error('‚ùå Error:', error);
        alert("Error de conexi√≥n");
        return false;
    }
}
</script>
    </body>
</html>
